{"version":3,"file":"apiz-vue.umd.js","sources":["apiz-vue.js"],"sourcesContent":["/* global DEBUG */\nimport { APIz } from 'apiz-ng';\nimport { config } from 'tinyjx';\nimport apizClient from 'apiz-browser-client';\n\nlet installed = false;\n\nfunction APIs(options) {\n\treturn new APIz(options.meta, {\n\t\timmutableMeta: true,\n\t\tdefaultType: 'json',\n\t\tclient: apizClient(options),\n\t\t...options\n\t});\n}\n\nAPIs.install = function (Vue, { pool = 5 } = {}) {\n\tif (installed) {\n\t\treturn;\n\t}\n\tinstalled = true;\n\n\tconfig({\n\t\tpool\n\t});\n\n\t// 其实我只想要hook根实例的beforeCreate而不是所有,\n\t// 然而好像没有什么很好的办法, 那就只能这样了\n\t// 至于为什么不直接通过options传入参数然后挂在\n\t// prototype上, 这样就可以不用使用mixin了, 因为\n\t// 我就希望API的调用方式是显式从根实例传入需要的参数\n\t// 而options则作为一些全局性的配置\n\tVue.mixin({\n\t\tbeforeCreate() {\n\t\t\t// 判断一下$root, 短路求值有利于减少其他组件实例化的判断\n\t\t\tif (this.$root === this && this.$options && this.$options.apis) {\n\t\t\t\tconst apis = this.$options.apis;\n\t\t\t\tswitch (true) {\n\t\t\t\t\tcase apis instanceof APIz:\n\t\t\t\t\t\tVue.prototype.$apis = apis;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase Array.isArray(apis):\n\t\t\t\t\t\tapis.forEach(item => Vue.prototype[item.name] = item.apiGroup);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase typeof apis.name === 'string' && apis.apiGroup instanceof APIz:\n\t\t\t\t\t\tVue.prototype[apis.name] = apis.apiGroup;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthrow new TypeError('apis must be an Object or an Array');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n};\n\nif (window && window.Vue) {\n\twindow.Vue.use(APIs);\n}\n\nexport default APIs;"],"names":["installed","APIs","options","APIz","meta","immutableMeta","defaultType","client","apizClient","install","Vue","pool","config","mixin","beforeCreate","$root","$options","apis","prototype","$apis","Array","isArray","forEach","item","name","apiGroup","TypeError","window","use"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;EAKA,IAAIA,SAAS,GAAG,KAAhB;;EAEA,SAASC,IAAT,CAAcC,OAAd,EAAuB;EACtB,SAAO,IAAIC,WAAJ,CAASD,OAAO,CAACE,IAAjB;EACNC,IAAAA,aAAa,EAAE,IADT;EAENC,IAAAA,WAAW,EAAE,MAFP;EAGNC,IAAAA,MAAM,EAAEC,UAAU,CAACN,OAAD;EAHZ,KAIHA,OAJG,EAAP;EAMA;;EAEDD,IAAI,CAACQ,OAAL,GAAe,UAAUC,GAAV,SAAkC;EAAA,gCAAJ,EAAI;EAAA,uBAAjBC,IAAiB;EAAA,MAAjBA,IAAiB,0BAAV,CAAU;;EAChD,MAAIX,SAAJ,EAAe;EACd;EACA;;EACDA,EAAAA,SAAS,GAAG,IAAZ;EAEAY,EAAAA,aAAM,CAAC;EACND,IAAAA,IAAI,EAAJA;EADM,GAAD,CAAN,CANgD;EAWhD;EACA;EACA;EACA;EACA;;EACAD,EAAAA,GAAG,CAACG,KAAJ,CAAU;EACTC,IAAAA,YADS,0BACM;EACd;EACA,UAAI,KAAKC,KAAL,KAAe,IAAf,IAAuB,KAAKC,QAA5B,IAAwC,KAAKA,QAAL,CAAcC,IAA1D,EAAgE;EAC/D,YAAMA,IAAI,GAAG,KAAKD,QAAL,CAAcC,IAA3B;;EACA,gBAAQ,IAAR;EACC,eAAKA,IAAI,YAAYd,WAArB;EACCO,YAAAA,GAAG,CAACQ,SAAJ,CAAcC,KAAd,GAAsBF,IAAtB;EACA;;EACD,eAAKG,KAAK,CAACC,OAAN,CAAcJ,IAAd,CAAL;EACCA,YAAAA,IAAI,CAACK,OAAL,CAAa,UAAAC,IAAI;EAAA,qBAAIb,GAAG,CAACQ,SAAJ,CAAcK,IAAI,CAACC,IAAnB,IAA2BD,IAAI,CAACE,QAApC;EAAA,aAAjB;EACA;;EACD,eAAK,OAAOR,IAAI,CAACO,IAAZ,KAAqB,QAArB,IAAiCP,IAAI,CAACQ,QAAL,YAAyBtB,WAA/D;EACCO,YAAAA,GAAG,CAACQ,SAAJ,CAAcD,IAAI,CAACO,IAAnB,IAA2BP,IAAI,CAACQ,QAAhC;EACA;;EACD;EACC,kBAAM,IAAIC,SAAJ,CAAc,oCAAd,CAAN;EAXF;EAaA;EACD;EAnBQ,GAAV;EAqBA,CArCD;;EAuCA,IAAIC,MAAM,IAAIA,MAAM,CAACjB,GAArB,EAA0B;EACzBiB,EAAAA,MAAM,CAACjB,GAAP,CAAWkB,GAAX,CAAe3B,IAAf;EACA;;;;;;;;"}